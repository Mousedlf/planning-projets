{% extends '@EasyAdmin/page/content.html.twig' %}

{% block content_title %}Planning{% endblock %}

{# {% block page_actions %}
    <a class="btn btn-primary" href="...">Some Action</a>
{% endblock %} #}

{% block main %}

<style>
.tab button.active {background-color: limegreen;}
</style>


<div class="d-flex"> 
     <div class="col-4">
          <h2>All projects</h2>
               <ul>
               {% for project in projects|sort((a, b) => a.name <=> b.name) %}
                    <li>
                         <span> {{ project.name}} ---- 
                         <span id="{{ project.id }}" class="text-secondary">{{ project.plannedHours }} </span> <!-- changement couleur -->
                         /{{ project.duration}} h ----</span>
                         <a href=" {{ ea_url().setRoute('add_assignment', {id: project.id}) }} ">assign</a>
                         <ul>
                              {% for person in project.peopleWorkingOnIt %}
                              <li>{{ person.name }}</li>
                              {% endfor %}

                         </ul>
                    </li>
               {% endfor %}
               </ul>

          </div>
          

          <div class="">
               {% for person in people %}

                    <h3 class="">{{ person.name }}</h3>
                    <ul>
                         {% for assignment in person.assignments|sort((a, b) => a.project.name <=> b.project.name) %}
                         <li>
                              <span> {{ assignment.project.name}}, {{ assignment.date|date("d/m/Y  H:i:s ")}}, {{ assignment.allotedTime}} h ----<!-- H:i:s --></span>
                              <a href=" {{ ea_url().setRoute('remove_assignment', {id: assignment.id}) }} ">remove</a>
                         </li> 
                         {% endfor %}
                    </ul>
               {% endfor %}
          </div>

</div>


     <div class="col-6">
     <div id='calendar'></div>
     </div>



<script>

 document.addEventListener('DOMContentLoaded', ()=> {
  
  const calendarEl = document.querySelector('#calendar');

  const calendar = new FullCalendar.Calendar(calendarEl, {
      initialView: 'dayGridYear',
      editable: true,
      buttonText: {
        today:false,
      },
      height: "100%",
    //  weekNumbers : true,
      weekText : "",
      navLinks : true,
      navLinkDayClick: function(date) {
        console.log(date.toISOString());
      },
    //  navLinkWeekClick: function() {},
      aspectRatio: 10,
      contentHeight: 'auto',
      multiMonthMaxColumns: 1,
      weekends : false,
      dayHeaders : false ,
      handleWindowResize: true,
      moreLinkClick : "popover", // ?*   
      eventBackgroundColor : '#378006',
      eventDisplay : 'background',
      events: {{ json|raw }}

    /// {{ json }}
    });

  calendar.render();
  }); 
</script>

{% endblock %}

{# {% block importmap %}{{ importmap('app') }}{% endblock %} #}
